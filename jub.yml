services:
 jub-ui:
  build:
    context: .
    dockerfile: Dockerfile
  image: ${JUB_UI_IMAGE:-jub:ui-0.0.1a0}
  ports:
    - ${JUB_UI_PORT:-8080}:80
  networks:
    - jub
  restart: unless-stopped

 jub-db:
  image: mongo:6-jammy
  ports:
    - ${JUB_MONGODB_PORT:-27027}:27017
  volumes:
    - jub-db:/data/db
  networks:
    - jub
  restart: unless-stopped
  
 jub:
  image: ${JUB_IMAGE_NAME:-nachocode/jub:api-0.0.1a0}
  env_file:
    - .env
  ports:
    - 5000:5000
  networks:
    - jub
  command: uvicorn jubapi.server:app --host ${JUB_HOST:-0.0.0.0} --port ${JUB_PORT:-5000} --reload
  # volumes:
    # - "/log:/log"

networks:
  jub:
volumes:
  jub-db:
